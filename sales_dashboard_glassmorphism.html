
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Glassmorphism Sales Dashboard</title>
<script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>

<style>
  :root {
    --bg: #e0f7ff; /* icy blue */
    --card: rgba(255, 255, 255, 0.25);
    --border: rgba(255, 255, 255, 0.4);
    --text: #0f172a;
  }

  body {
    margin: 0;
    padding: 24px;
    background: var(--bg);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  }

  .container {
    max-width: 1200px;
    margin: auto;
  }

  header {
    margin-bottom: 20px;
    text-align: center;
  }

  .title {
    font-size: 28px;
    font-weight: 700;
    color: var(--text);
  }

  .glass {
    background: var(--card);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border: 1px solid var(--border);
    border-radius: 18px;
    padding: 40px; /* adjusted padding (about 40%) */
    margin-bottom: 25px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.15);
  }

  input[type="file"] {
    background: rgba(255,255,255,0.6);
    padding: 10px;
    border-radius: 10px;
    border: 1px solid var(--border);
  }

  .grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 25px;
  }

  @media(min-width: 900px) {
    .grid {
      grid-template-columns: 1fr 1fr;
    }
    .full {
      grid-column: 1 / -1;
    }
  }

  .chart {
    width: 100%;
    height: 360px;
  }

  label {
    font-weight: 600;
    color: var(--text);
  }

</style>
</head>

<body>
  <div class="container">
    <header>
      <div class="title">Interactive Glassmorphism Sales Dashboard</div>
    </header>

    <div class="glass">
      <label>Upload Sales JSON File</label><br><br>
      <input type="file" id="fileInput" accept="application/json" />
    </div>

    <div class="grid">
      <div class="glass full">
        <h3>Monthly Sales Trend</h3>
        <div id="monthlyChart" class="chart"></div>
      </div>

      <div class="glass">
        <h3>Total Sales by Product</h3>
        <div id="productChart" class="chart"></div>
      </div>

      <div class="glass">
        <h3>Sales by Region</h3>
        <div id="regionChart" class="chart"></div>
      </div>

      <div class="glass">
        <h3>Sales by Category</h3>
        <div id="categoryChart" class="chart"></div>
      </div>

      <div class="glass full">
        <h3>Top Cities by Sales</h3>
        <div id="cityChart" class="chart"></div>
      </div>
    </div>
  </div>

<script>
document.getElementById("fileInput").addEventListener("change", handleFile);

function handleFile(e) {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = (ev) => {
    const json = JSON.parse(ev.target.result);
    const data = Array.isArray(json) ? json : [json];
    renderDashboard(data);
  };
  reader.readAsText(file);
}

function renderDashboard(data) {
  const sumBy = (arr, key) => {
    const map = new Map();
    arr.forEach(row => {
      const k = row[key] || "Unknown";
      const v = Number(row.TotalSales) || 0;
      map.set(k, (map.get(k) || 0) + v);
    });
    return map;
  };

  /* Monthly */
  const monthly = new Map();
  data.forEach(r => {
    const d = new Date(r.Date);
    if (!isNaN(d)) {
      const key = d.getFullYear() + "-" + String(d.getMonth()+1).padStart(2,"0");
      monthly.set(key, (monthly.get(key)||0) + r.TotalSales);
    }
  });

  Plotly.newPlot("monthlyChart", [{
    x: [...monthly.keys()],
    y: [...monthly.values()],
    type: "scatter", mode: "lines+markers"
  }], {title:"Monthly Sales Trend"});

  /* Product */
  const product = sumBy(data, "Product");
  Plotly.newPlot("productChart", [{
    x: [...product.keys()],
    y: [...product.values()],
    type:"bar"
  }], {title:"Sales by Product"});

  /* Region */
  const region = sumBy(data, "Region");
  Plotly.newPlot("regionChart", [{
    x:[...region.keys()],
    y:[...region.values()],
    type:"bar"
  }], {title:"Sales by Region"});

  /* Category */
  const category = sumBy(data, "Category");
  Plotly.newPlot("categoryChart", [{
    labels:[...category.keys()],
    values:[...category.values()],
    type:"pie", hole:0.45
  }], {title:"Sales by Category"});

  /* City */
  const city = sumBy(data, "City");
  const sorted = [...city.entries()].sort((a,b)=>b[1]-a[1]);
  Plotly.newPlot("cityChart", [{
    x: sorted.map(e=>e[1]),
    y: sorted.map(e=>e[0]),
    type:"bar", orientation:"h"
  }], {title:"Top Cities by Sales"});
}
</script>

</body>
</html>
